pipeline{
    agent{
        dockerfile{
            filename "Dockerfile"
            args "--entrypoint=''"
        }
    }

    stages{
        stage('version k6'){
            steps{
                sh 'k6 -v'
            }
        }

        stage('Run tests'){
            steps{
                sh 'k6 run script.js --out json=test_results.json script.js'
            }
        }
    }
}